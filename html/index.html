<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>云API</title>
    <link rel="stylesheet" type="text/css" href="../css/api.css"/>
    <link rel="stylesheet" type="text/css" href="../css/aui.css"/>
    <link rel="stylesheet" type="text/css" href="../css/style.css"/>
    <style>
    .aui-bar-btn-item.aui-active{
      background-color: transparent;
      color : #000;
    }
    
    .aui-bar-btn-item{
      border-color: #ddd;
    }
    </style>
</head>
<body>

  <header>
    <div class="aui-bar aui-bar-btn aui-bar-btn-full">
        <div class="aui-bar-btn-item aui-active both" tapmode="hover" sortField="price">价格</div>
        <div class="aui-bar-btn-item both" tapmode="hover" sortField="sales">人气</div>
        <div class="aui-bar-btn-item both" tapmode="hover" sortField="time">时间</div>
    </div>
  </header>
    

<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/zepto.min.js"></script>
<script type="text/javascript" src="../script/shop.js"></script>
<script type="text/javascript">

apiready = function () {
   api.parseTapmode();
   
   //alert(api.pageParam['parentY']); 
   api.openFrame({
	   name: 'content-list',
	   url: 'goods_list_frm.html',
	   bounces : true,
	   rect: {
		   x:0,
		   y: api.pageParam['parentY'] + $api.dom('header').offsetHeight - 1,//$api.dom('header').offsetTop+$api.dom('header').offsetHeight,
		   w:'auto',
		   h:api.pageParam['parentHeight'] - $api.dom('header').offsetHeight
	   }
   });
   
   initSortBtn();
}


function initSortBtn(){
  var bothClass = 'both';
  var ascClass = 'asc';
  var descClass = 'desc';
  // both 0 -> asc 1 -> desc 2
  var sortVal = 0;

  var el = $('.both').on('click',function(e){
    var $this = $(this);
    if($this.hasClass(bothClass)){
      $this.removeClass(bothClass);
      $this.addClass(ascClass);
      sortVal = 1;
    } else if ($this.hasClass(ascClass)){
      $this.removeClass(ascClass);
      $this.addClass(descClass);
      sortVal = 2;      
    } else if ($this.hasClass(descClass)){
      $this.removeClass(descClass);
      $this.addClass(bothClass);
      sortVal = 0;
    } else {
      $this.removeClass(bothClass);
      $this.removeClass(ascClass);
      $this.removeClass(descClass);
      $this.addClass(bothClass);
      sortVal = 0;
    }
    
    var el2 = el.not($this);
    if(el2.hasClass(bothClass)){
      el2.removeClass(bothClass);
    }
    if(el2.hasClass(ascClass)){
      el2.removeClass(ascClass);
    }
    if(el2.hasClass(descClass)){
      el2.removeClass(descClass);
    }
    el2.addClass(bothClass);
    
    api.sendEvent({
	    name:'sortGoods',
	    extra : {
	     'sortField' : $this.attr('sortField'),
	     'sortVal' : sortVal
	    }
    });
    
    
  });
}



/*
var bar = document.querySelectorAll(".aui-bar-btn");
if(bar){
    for(var i=0; i<bar.length;i++){
        var d = bar[i];
        var tab = new auiTab({
            element:bar[i],
            repeatClick:true
        },function(ret){
            if(ret.dom.parentNode.getAttribute("type") && ret.dom.parentNode.getAttribute("type")=="count"){
                var count = parseInt(document.getElementById("count").value);
                if(ret.index==2)return;
                if(ret.index==1){
                    document.getElementById("count").value = count-1;
                }
                if(ret.index==3){
                    document.getElementById("count").value = count+1;
                }
            }
        });

    }
}
*/
</script>
</body>
</html>