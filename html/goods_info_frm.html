<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
    <meta name="viewport" content="maximum-scale=1.0,minimum-scale=1.0,user-scalable=0,width=device-width,initial-scale=1.0"/>
    <meta name="format-detection" content="telephone=no,email=no,date=no,address=no">
    <title>商品详情</title>
    <link rel="stylesheet" type="text/css" href="../css/aui.css"/>
    <link rel="stylesheet" type="text/css" href="../css/swiper-3.3.1.min.css"/>
    <link rel="stylesheet" type="text/css" href="../css/goods_select.css"/>
    <link rel="stylesheet" type="text/css" href="../css/style.css"/>
    <style>
  	body{
  	 background-color: #ffffff !important;
  	}
    	
    	
    	
    .swiper-container{
      background: #FCFCFC !important;
    }
    
    .swiper-slide{
      height: 380px;
    }
    
    .swiper-slide img{
      width: auto;
      max-width: 100%;
      height: auto;
      max-height: 100%;
      margin: 0 auto;
    }
    
    .txtArea{
      border: 1px solid #ddd;
      width: 100%;
      border-radius: 10px;
      height: 120px;
      padding: 5px;
    }
    
    .aui-bar-btn{
      width: 140px;
      margin: 0px;
      display: inline-table;
    }
    
    .aui-bar-btn-item{
      border-color: #D9D9D9;
    }
    
    .num_bug{
      background-color: #ff8f0f;
      color : #fff;
      border-color: #ff8f0f !important;
    }

    
    </style>
</head>
<body>
  
  <!--
  <div class="aui-row">
    <div class="aui-col-xs-12 goods_spec">
      <span>尺　　寸：</span>
      <label style="background-color: #ffffff;" class="selected">
        <input class="size" type="checkbox" name="size" value="ffffff" />
        白色
      </label>
      <label style="background-color: #dda0dd;">
        <input class="size" type="checkbox" name="size" value="dda0dd" />
        紫罗兰色
      </label>
      <label style="background-color: #008000;">
        <input class="size" type="checkbox" name="size" value="008000" />
        绿色
      </label>
    </div>
  </div>
  -->

  
</body>
<script type="text/javascript" src="../script/api.js"></script>
<script type="text/javascript" src="../script/aui-tab.js" ></script>
<script type="text/javascript" src="../script/zepto.min.js"></script>
<script type="text/javascript" src="../script/doT.min.js"></script>
<script type="text/javascript" src="../script/swiper-3.3.1.min.js"></script>
<script type="text/javascript" src="../script/shop.js"></script>



<script type="text/x-dot-template" id="content-tpl">

<div id="img-slide" class="swiper-container">
  <div class="swiper-wrapper">
  {{ for(var i=0;i<it.images.length;i++){ }}
    <div class="swiper-slide"><img src="{{= it.images[i].goods_image}}" alt="1"></div>
  {{ } }}
  </div>
  <div class="swiper-pagination"></div>
</div>
<div class="aui-hr"></div>

<div class="aui-content aui-content-padded">
  <div class="aui-row">
    <div class="aui-col-xs-10 aui-font-size-16" style="border-right: 1px solid #ccc;">{{= it.goods_name}}</div>
    <div class="aui-col-xs-2 aui-text-center" tapmode onclick="favGoods();return false;">
       <i class="aui-iconfont aui-icon-like aui-text-danger"></i>
       <p>收藏</p>
    </div>  
  </div>
  
  <div class="aui-row aui-margin-t-15 aui-font-size-14">
    <div class="aui-col-xs-12">货　号： {{= it.goods_item}}</div>
  </div>
  <div class="aui-row aui-font-size-14">
    <div class="aui-col-xs-12">市场价： <span style="text-decoration:line-through;color: #ccc;">￥ {{= it.goods_price}} 元</span></div>
  </div>
  <div class="aui-row aui-font-size-14">
    <div class="aui-col-xs-12">店铺价： <span class="aui-text-warning">￥ {{= it.goods_shop_price }} 元</span></div>
  </div>
  <div class="aui-row aui-font-size-14">
    <div class="aui-col-xs-6">库　存： {{= it.goods_stock}}</div>
    <div class="aui-col-xs-6">销　量：{{= it.goods_sales}}</div>
  </div>
  
</div>

<div class="aui-hr"></div>

<div class="aui-content aui-content-padded aui-font-size-14">
  <div class="aui-row aui-margin-b-10">
    <div class="aui-col-xs-12 goods_spec specColor">
      <span>颜　　色：</span>
      {{ for(var i=0;i<it.color.list.length;i++){ }}
      <label>
        <input class="color" type="checkbox" name="color" value="{{= it.color.list[i].value}}" onclick="doSepcSelected(this,'.specColor');" />
        <i style="background-color: #{{= it.color.list[i].value}};">&nbsp;</i>
        {{= it.color.list[i].info}}
      </label>
      {{ } }}
    </div>
  </div>
  <div class="aui-row aui-margin-b-10">
    <div class="aui-col-xs-12 goods_spec specSize">
      <span>尺　　寸：</span>
      {{ for(var i=0;i<it.size.list.length;i++){ }}
      <label>
        <input class="size" type="checkbox" name="size" value="{{= it.size.list[i].value}}" onclick="doSepcSelected(this,'.specSize');" />
        {{= it.size.list[i].info}}
      </label>
      {{ } }}
    </div>
  </div>
  <div class="aui-row">
    <div class="aui-col-xs-12">
      <span>购买数量：</span>
      <div class="aui-bar aui-bar-btn" style="vertical-align: middle;" type="count">
        <div class="aui-bar-btn-item num_bug" tapmode onclick="minus(1);return false;">
            <i class="aui-iconfont aui-icon-minus"></i>
        </div>
        <div class="aui-bar-btn-item">
            <input id="buyNum" type="number" class="aui-input aui-text-center" value="0" />
        </div>
        <div class="aui-bar-btn-item num_bug" tapmode onclick="plus(1);return false;">
            <i class="aui-iconfont aui-icon-plus"></i>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="aui-hr"></div>

<div class="aui-tab" id="tab">
    <div class="aui-tab-item aui-active">商品详情</div>
    <div class="aui-tab-item">评价</div>
    <div class="aui-tab-item">商品咨询</div>
</div>

<div class="aui-hr"></div>

<div id="t1" class="tab-content aui-content aui-content-padded aui-font-size-14">
{{= it.goods_body}}
</div>

<div id="t2" class="tab-content aui-content aui-content-padded aui-font-size-14" style="display: none;">
  <div class="aui-text-center aui-margin-b-15">该商品暂时没有评价</div>
  <!--
  <ul id="appraiseList" class="aui-list aui-media-list">
  </ul>
  -->
</div>

<div id="t3" class="tab-content aui-content aui-content-padded aui-font-size-14" style="display: none;">
  <div class="aui-text-center aui-margin-b-15">该商品暂时没有咨询</div>
  <!--
  <ul id="askList" class="aui-list aui-media-list">
  </ul>
  -->
  
  <div class="aui-row">
    <div class="aui-col-xs-12">
      <textarea placeholder="请输入您需要咨询的内容！" class="txtArea" ></textarea>
    </div>
  </div>
  
  <div class="aui-row aui-margin-t-10">
    <div class="aui-col-xs-12">
      <div class="aui-btn aui-btn-info aui-btn-block" tapmode>提交咨询</div>
    </div>
  </div>
</div>



</script>


<script type="text/javascript">
	var classId = "";
	var goodsId = "";
	var dot;
	var maxNum = 100;//最大可购买数量
	
	apiready = function(){
	 classId = api.pageParam['one_class_id'];
   goodsId = api.pageParam['goods_id'];
   var dot = $api.byId('content-tpl');
   dot = doT.template(dot.innerHTML);
   
	 $shop.getGoodsInfo(classId,goodsId,function(resp){
	   if(resp && 'success' == resp.status){
       var data = resp.result;
       
       //console.log('>>>>> image'+JSON.stringify(data));
      $api.dom('body').innerHTML = dot(data);
      
      //初始化滚动图片
      var mySwiper = new Swiper ('.swiper-container', {
        loop: true,
        pagination: '.swiper-pagination'
      })
      
      //初始化tab
      var tab = new auiTab({
          element:document.getElementById("tab"),
          index:1,
          repeatClick:false
      },function(ret){
          //console.log(JSON.stringify(ret));
        var index = ret.index;
        var $tabs = $('.tab-content');
        
        $tabs.hide();
        $('#t'+index).show();
      });
      
         
	   } else {
	   
	   }
	 });
	   
	};
	
	
	/**
	 * 收藏商品 
	 */
	function favGoods(){
	 
	}
	
	
	function listAppraise(){
	
	}
	
	
	/**
	 * 处理商品规格的 UI 逻辑 
	 */
	function doSepcSelected(obj,className){
	 var $this = $(obj);
	 //alert($this.is(':checked'));
	 if($this.is(':checked')){
	   var $all = $(className + ' input');
	   $all.prop('checked',false);
	   $all.parent().removeClass('selected');
	   
	   $this.prop('checked',true);
	   $this.parent().addClass('selected');
	 } else {
	   $this.parent().removeClass('selected');
	 }
	}
	
	
	/**
	 * 减去按钮逻辑 
	 */
	function minus(val){
	 var $inp = $('#buyNum');
	 var rs = parseInt($inp.val()) - parseInt(val);
	 rs = isNaN(rs)?0:rs;
	 $inp.val(rs<0?0:rs);
	}
	
	
	/**
	 * 增加按钮逻辑 
	 */
	function plus(val){
   var $inp = $('#buyNum');
   var rs = parseInt($inp.val()) + parseInt(val);
   rs = isNaN(rs)?0:rs;
   if(rs > maxNum){
    api.toast({
	    msg:'亲，最大的购买数量不能超过 '+maxNum+',还请谅解，谢谢惠顾！'
    });
    rs = maxNum;
   } 
   
   $inp.val(rs);
	}
</script>



</html>